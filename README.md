# Практическое задание №1
## Малько Егор Александрович

Запустить тесты можно через идею или командную строку с docker:
```
docker build -t gradle-test-image .
docker run --rm -it gradle-test-image gradle test
```
У меня тесты проходят за 3 минуты

Код `seq` и `par` расположен в [Main.kt](src/main/kotlin/Main.kt)

Тесты на расположены в [Test.kt](src/test/kotlin/Test.kt)
1. корректность (`testSeqCorrectness` и `testParCorrectness`)
2. сравнение время исполнения (`compareSpeed`)

## Код сортировки

Метод `partition`: часть алгоритма quicksort 
- выбирается опорный элемент из отрезка массива
- элементы массива сортируется относительно опорного элемента в один проход на две части
- те что меньше - слева, те что больше - справа
- возвращает правую границу левой части и левую правой 

Метод `seq`
- Вызывает `partition` на отрезке
- последовательно запускаем `seq` от двух частей если их размер хотя бы 2

Метод `par`
- Если размер отрезка меньше 10000 (`PARALLELISM_BORDER`), то запускаем seq
- иначе вызываем `partition` на отрезке
- и параллельно запускаем `par` двух частей если их размер хотя бы 2

`PARALLELISM_BORDER` подобран экспериментально

Параллельный код выполняется на 4 потоках (см `context` в [Main.kt](src/main/kotlin/Main.kt)). 
В этом можно убедиться поменяв количество потоков при инициализации context и запустив тесты. 
Например, я временно поменял количество тредов с 4 на 16, и `par` стал быстрее `seq` в 7 раз, а не в 3

## Тесты

В тестах `testSeqCorrectness` и `testParCorrectness` проверяется корректность алгоритмов. 
- Создается изначальный массив размера 10^6 из случайных элементов и его копия
- Проверяется что изначальный массив отсортированный стандартным методом kotlin, 
равен копии отсортированной с помощью `seq` или `par` соответственно
- повторяется 10 раз

В тесте `compareSpeed`
- Создается изначальный массив размера 10^8 из случайных элементов
- Сортируем массив замеряя время
- 5 раз повторяем сортируя через `seq` и находим среднее время
- 5 раз повторяем сортируя через `par` и находим среднее время
- проверяем что среднее время `par` быстрее `seq` как минимум в 3 раза

В моем случае получилось быстрее в 3.26 раза

![Результат](img.png)
